!function(t,e){"use strict";function o(t,e,o){this.$element=t,this.element=t[0],this.controller=e,this.fields=o||[]}function i(t,e){this.$element=t,this.element=t[0],this.controller=e}o.prototype.register=function(t){this.fields.push(t)},o.prototype.unregister=function(t){var e=this.fields.indexOf(t);this.fields.splice(e,1)},e.module("ngValidation",["ng"]).provider("$tooltip",function(){var t=this.defaults={show:!0,placement:"top",template:['<div class="tooltip in" ng-show="show && title">','<div class="tooltip-arrow"></div>','<div class="tooltip-inner" ng-bind="title"></div>',"</div>"].join("")};this.$get=["$rootScope","$compile","$timeout","$dimensions",function(o,i,n,s){function r(r,l){var f={},a=f.$options=e.extend({},t,l),c=f.$scope=a.scope&&a.scope.$new()||o.$new(),d=e.element(a.template),u=i(d);return f.destroy=function(){d.remove(),c.$destroy()},f.setScope=function(t){t&&e.forEach(["title","show"],function(o){e.isDefined(t[o])&&(c[o]=t[o])})},f.position=function(){var t=s.getPosition(r[0],!1),e=d.prop("offsetWidth"),o=d.prop("offsetHeight"),i=s.getCalculatedOffset(a.placement,t,e,o);i.top+="px",i.left+="px",d.css(i)},f.init=function(){this.setScope(a),u(c),d.css({top:"-9999px",left:"-9999px"}),d.addClass(a.placement),r.after(d),n(this.position)},f.show=function(t){this.setScope(e.extend({show:!0},t))},f.hide=function(){this.setScope({show:!1})},f.init(),f}return r}]}).provider("validationMessage",function(){var t=this.defaults={messages:{required:"必填！",number:"必须为数字！",minlength:"太短！",maxlength:"太长！",email:"Email无效！",url:"URL无效！",pattern:"格式不正确！"},defaultMessage:"验证不通过！"};this.setMessages=function(o){return e.extend(t.messages,o)},this.setDefaults=function(t){return e.extend(this.defaults,t)},this.$get=[function(){return t}]}).provider("validator",function(){this.$get=["$parse","validationMessage","$tooltip",function(t,e,o){var i={validateField:function(o){var n=o.controller;if(n.$dirty&&n.$invalid){var s=Object.keys(n.$error),r=s[0],l=t(o.$element.attr("message"))(),f=l&&l[r]||e.messages[r]||e.defaultMessage;console.log(r,f,n),i.showMessage(o,f)}else i.hideMessage(o)},showMessage:function(t,e){var i=t.$element,n=i.data("tooltip");n?n.show({title:e}):(n=o(t.$element,{title:e}),i.data("tooltip",n)),console.log(n)},hideMessage:function(t){var e=t.$element.data("tooltip");e&&e.hide()}};return i}]}).directive("validationForm",[function(){return{restrict:"A",require:"form",compile:function(t){var e=t[0];return e.noValidate=!0,function(t,e,i,n){var s=new o(e,n);console.log(s)}}}}]).directive("validationField",["$timeout","validator",function(t,e){return{restrict:"A",require:["ngModel","?^validationForm"],compile:function(){return function(o,n,s,r){function l(o){return t(function(){e.validateField(c)}),o}var f=r[0],a=r[1],c=new i(n,f);f.$parsers.push(l),f.$formatters.push(l),console.log(c,a)}}}}]).factory("$dimensions",["$document","$window",function(){var e={},o=e.nodeName=function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()};e.css=function(e,o,i){var n;return n=e.currentStyle?e.currentStyle[o]:t.getComputedStyle?t.getComputedStyle(e)[o]:e.style[o],i===!0?parseFloat(n)||0:n},e.offset=function(e){var o=e.getBoundingClientRect(),i=e.ownerDocument;return{width:o.width||e.offsetWidth,height:o.height||e.offsetHeight,top:o.top+(t.pageYOffset||i.documentElement.scrollTop)-(i.documentElement.clientTop||0),left:o.left+(t.pageXOffset||i.documentElement.scrollLeft)-(i.documentElement.clientLeft||0)}},e.position=function(t){var n,s,r={top:0,left:0};return"fixed"===e.css(t,"position")?s=t.getBoundingClientRect():(n=i(t),s=e.offset(t),o(n,"html")||(r=e.offset(n)),r.top+=e.css(n,"borderTopWidth",!0),r.left+=e.css(n,"borderLeftWidth",!0)),{width:t.offsetWidth,height:t.offsetHeight,top:s.top-r.top-e.css(t,"marginTop",!0),left:s.left-r.left-e.css(t,"marginLeft",!0)}};var i=function(t){var i=t.ownerDocument,n=t.offsetParent||i;if(o(n,"#document"))return i.documentElement;for(;n&&!o(n,"html")&&"static"===e.css(n,"position");)n=n.offsetParent;return n||i.documentElement};return e.height=function(t,o){var i=t.offsetHeight;return o?i+=e.css(t,"marginTop",!0)+e.css(t,"marginBottom",!0):i-=e.css(t,"paddingTop",!0)+e.css(t,"paddingBottom",!0)+e.css(t,"borderTopWidth",!0)+e.css(t,"borderBottomWidth",!0),i},e.width=function(t,o){var i=t.offsetWidth;return o?i+=e.css(t,"marginLeft",!0)+e.css(t,"marginRight",!0):i-=e.css(t,"paddingLeft",!0)+e.css(t,"paddingRight",!0)+e.css(t,"borderLeftWidth",!0)+e.css(t,"borderRightWidth",!0),i},e.getCalculatedOffset=function(t,e,o,i){var n,s=t.split("-");switch(s[0]){case"right":n={top:e.top+e.height/2-i/2,left:e.left+e.width};break;case"bottom":n={top:e.top+e.height,left:e.left+e.width/2-o/2};break;case"left":n={top:e.top+e.height/2-i/2,left:e.left-o};break;default:n={top:e.top-i,left:e.left+e.width/2-o/2}}if(!s[1])return n;if("top"===s[0]||"bottom"===s[0])switch(s[1]){case"left":n.left=e.left;break;case"right":n.left=e.left+e.width-o}else if("left"===s[0]||"right"===s[0])switch(s[1]){case"top":n.top=e.top-i;break;case"bottom":n.top=e.top+e.height}return n},e.getPosition=function(t,o){return o?e.offset(t):e.position(t)},e}])}(window,window.angular);